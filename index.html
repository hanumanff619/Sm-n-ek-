<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Směnářek</title>
  <meta name="theme-color" content="#102a4a">

  <!-- PWA / ikony -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">

  <!-- ZÁKLADNÍ STYL (ponecháno co nejmenší – hlavní styly máš v appu) -->
  <style>
    :root{
      --bg:#0c1d33;--panel:#122e52;--ink:#eaf2ff;
      --muted:#9fb9d4;--sel:#1e78d7;--good:#5bd39a;
    }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif}
    .wrap{max-width:1200px;margin:0 auto;padding:1rem}
    header{display:flex;align-items:center;justify-content:center;gap:1rem;padding:1.25rem 0}
    header h1{margin:.2rem 0 0;font-size:2.25rem;letter-spacing:.5px}
    .topbar{display:flex;align-items:center;justify-content:space-between}
    .btn{appearance:none;border:1px solid rgba(255,255,255,.2);background:transparent;color:var(--ink);padding:.6rem .9rem;border-radius:.8rem;cursor:pointer}
    .btn.primary{background:var(--sel);border-color:transparent}
    .card{background:var(--panel);border-radius:18px;padding:1rem;margin:1rem 0}
    .row{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center}
    .todayLine{color:var(--good);font-weight:700}
    .result{background:#11422c;margin:.5rem 0;border-radius:.8rem;padding:.9rem 1rem}
    .result h3{margin:0 0 .25rem 0;font-size:1rem}
    .result .val{font-size:1.25rem}
    .signature{padding:2rem 0 3rem;text-align:center;color:#9fb9d4}
    .signature b{color:#fff}
    .sigline{margin-top:.4rem;font-weight:700}
    .sigline .me{color:#4aa3ff}
    .sigline .and{color:#ff4a6e}
    .sigline .ai{color:#ff7db1}

    /* ===== Modal Nastavení ===== */
    #settingsModal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:30}
    #settingsModal .sheet{width:min(760px,92vw);max-height:88vh;overflow:auto;background:var(--panel);border-radius:18px;padding:1rem 1rem 1.25rem}
    #settingsModal h3{margin:.2rem 0 1rem;font-size:1.25rem}
    .section{margin:1rem 0}
    .section h4{margin:.25rem 0 .7rem}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
    label{display:block;margin:.25rem 0 .25rem;color:var(--muted)}
    input[type="text"],input[type="number"],select{width:100%;box-sizing:border-box;border-radius:.7rem;border:1px solid rgba(255,255,255,.2);background:#0f2644;color:var(--ink);padding:.6rem .7rem}
    .actions{display:flex;gap:.6rem;justify-content:flex-end;margin-top:1rem}
    .hint{color:#9fb9d4;font-size:.9rem}
    .chip{display:inline-block;padding:.3rem .55rem;border:1px solid rgba(255,255,255,.25);border-radius:.6rem}
    .todayBox{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}
    .calendarNav .btn{border-radius:12px}
    .results-wrap{background:var(--panel);border-radius:18px;padding:1rem}
    .sumline{color:#9fb9d4;margin-top:.6rem}
  </style>
</head>
<body>

  <div class="wrap">

    <!-- horní lišta s nastavením -->
    <div class="topbar">
      <div style="width:48px"></div>
      <header>
        <img src="icons/icon-192.png" alt="" width="56" height="56" style="filter:drop-shadow(0 2px 2px rgba(0,0,0,.35))">
        <h1>Směnářek</h1>
      </header>
      <button class="btn" id="openSettings">⚙️ Nastavení</button>
    </div>

    <!-- KALENDÁŘ -->
    <section class="card" id="card-calendar">
      <h2 style="margin:.3rem 0 .75rem">Kalendář</h2>
      <div class="row calendarNav">
        <button class="btn" id="prevMonth">←</button>
        <button class="btn" id="monthLabel">—</button>
        <button class="btn" id="nextMonth">→</button>
      </div>

      <div class="todayBox" style="margin-top: .8rem">
        <div class="todayLine" id="todayShift">Dnes: —</div>
        <div class="todayLine" id="todayNameday">Svátek: —</div>
      </div>

      <!-- tady si tvoje JS vykresluje tabulku kalendáře -->
      <div id="calendarHost" style="margin-top:1rem"></div>
    </section>

    <!-- VÝSLEDKY -->
    <section class="card">
      <h2 style="margin:.3rem 0 .75rem">Výsledky</h2>

      <div class="results-wrap">
        <div class="result">
          <h3>Čistá mzda</h3>
          <div class="val" id="resNet">0,00 Kč</div>
        </div>
        <div class="result">
          <h3>Stravenky</h3>
          <div class="val" id="resVouchers">0,00 Kč</div>
        </div>
        <div class="result">
          <h3>Cafeterie</h3>
          <div class="val" id="resCafeteria">0,00 Kč</div>
        </div>

        <div class="sumline" id="resYearSum">Součet za rok: 0,00 Kč</div>
      </div>
    </section>

    <!-- PODPIS -->
    <div class="signature">
      <div><b>Směnářek 2.0</b></div>
      <div class="sigline"><span class="me">Hanuman</span> <span class="and">&amp;</span> <span class="ai">Terezka AI</span></div>
    </div>
  </div>

  <!-- ========== MODAL NASTAVENÍ (okno přes stránku) ========== -->
  <div id="settingsModal" aria-hidden="true">
    <div class="sheet">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem">
        <h3>⚙️ Nastavení</h3>
        <button class="btn" id="btnClose">Zavřít</button>
      </div>

      <!-- Režim směn -->
      <div class="section">
        <h4>Režim směn</h4>
        <div class="grid2">
          <label><input type="radio" name="st_mode" id="st_mode12" value="12"> 12 h (D/N/V)</label>
          <label><input type="radio" name="st_mode" id="st_mode8" value="8"> 8 h (R/O/N/V)</label>
        </div>
        <div class="hint">Pozadí pro 12 h/8 h se načítá z <span class="chip">backgrounds/</span></div>
      </div>

      <!-- Jazyk & měna -->
      <div class="section">
        <h4>Jazyk a měna</h4>
        <div class="grid2">
          <div><label>Jazyk</label>
            <select id="st_lang">
              <option value="cs">Čeština</option>
              <option value="en">English</option>
              <option value="de">Deutsch</option>
            </select>
          </div>
          <div><label>Měna</label>
            <select id="st_ccy">
              <option value="CZK">Kč</option>
              <option value="EUR">€</option>
              <option value="USD">$</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Stravenky a obědy -->
      <div class="section">
        <h4>Stravenky a obědy</h4>
        <div class="grid2">
          <div><label>Cena obědu (Kč/ks)</label><input id="st_meal_price" type="number" step="0.01" min="0"></div>
          <div><label>Cena stravenky – srážka (Kč/ks)</label><input id="st_voucher_deduct" type="number" step="0.01" min="0"></div>
          <div><label>Hodnota stravenky – zaměstnanec (Kč/ks)</label><input id="st_voucher_gain" type="number" step="0.01" min="0"></div>
          <div><label>Stravenky za denní</label><input id="st_v_per_day" type="number" step="1" min="0"></div>
          <div><label>Stravenky za noční</label><input id="st_v_per_night" type="number" step="1" min="0"></div>
        </div>
      </div>

      <!-- Příplatky a bonusy -->
      <div class="section">
        <h4>Příplatky a bonusy</h4>
        <div class="grid2">
          <div><label>Základní hodinovka (Kč/h)</label><input id="st_w_base" type="number" step="0.01"></div>
          <div><label>Přímé prémie (%)</label><input id="st_bonus_pct" type="number" step="0.01" value="10"></div>
          <div><label>Odpolední (Kč/h)</label><input id="st_b_afternoon" type="number" step="0.01"></div>
          <div><label>Noční (Kč/h)</label><input id="st_b_night" type="number" step="0.01"></div>
          <div><label>Víkend (Kč/h)</label><input id="st_b_weekend" type="number" step="0.01"></div>
          <div><label>Svátek (Kč/h) – odpracovaný</label><input id="st_b_holiday_worked" type="number" step="0.01"></div>
          <div><label>Nepřetržitý provoz (Kč/h)</label><input id="st_b_continuous" type="number" step="0.01"></div>
          <div><label>Prémie z fondu vedoucího (Kč)</label><input id="st_mgr_bonus" type="number" step="0.01"></div>
          <div style="grid-column:1/-1"><label><input type="checkbox" id="st_year_bonus_on"> Roční motivační (Kč, auto 6 &amp; 11)</label><input id="st_year_bonus" type="number" step="0.01" style="margin-left:.6rem;width:180px"></div>
        </div>
      </div>

      <!-- Dovolená & průměrná náhrada -->
      <div class="section">
        <h4>Dovolená &amp; průměrná náhrada</h4>
        <div class="grid2">
          <div><label>Dovolená (hod/den)</label><input id="st_vac_hours_per_day" type="number" step="0.01"></div>
          <div><label>Ručně zadaná průměrná náhrada (Kč/h)</label><input id="st_avg_manual" type="number" step="0.01"></div>
        </div>
        <div class="hint">Automatika: průměr z M-1, M-2, M-3 = čisté mzdy ÷ hodiny (pole jsou v aplikaci, schovaná v nastavení).</div>
      </div>

      <!-- tlačítka -->
      <div class="actions">
        <button class="btn" id="btnCancel">Zrušit</button>
        <button class="btn primary" id="btnSave">Uložit nastavení</button>
      </div>
    </div>
  </div>

  <!-- APP LOGIKA -->
  <script src="app_v2.js"></script>

  <!-- modal open/close – minimalistický drátek, zbytek řeší app_v2.js -->
  <script>
    const modal = document.getElementById('settingsModal');
    const openBtn = document.getElementById('openSettings');
    const closeBtn = document.getElementById('btnClose');
    const cancelBtn = document.getElementById('btnCancel');

    function showModal(){ modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); }
    function hideModal(){ modal.style.display='none'; modal.setAttribute('aria-hidden','true'); }

    openBtn?.addEventListener('click', showModal);
    closeBtn?.addEventListener('click', hideModal);
    cancelBtn?.addEventListener('click', hideModal);
    modal?.addEventListener('click', (e)=>{ if(e.target===modal) hideModal(); });
  </script>
</body>
</html>
